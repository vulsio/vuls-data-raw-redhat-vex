{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "moderate"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/v2/vex/2022/cve-2022-48674.json"
			}
		],
		"title": "kernel: erofs: fix pcluster use-after-free on UP platforms",
		"tracking": {
			"current_release_date": "2024-09-19T15:16:10+00:00",
			"generator": {
				"date": "2024-09-19T15:16:10+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.33.3"
				}
			},
			"id": "CVE-2022-48674",
			"initial_release_date": "2022-01-01T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2022-01-01T00:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-09-19T15:05:23+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-09-19T15:16:10+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 6",
								"product": {
									"name": "Red Hat Enterprise Linux 6",
									"product_id": "red_hat_enterprise_linux_6",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:6"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 6"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 7",
								"product": {
									"name": "Red Hat Enterprise Linux 7",
									"product_id": "red_hat_enterprise_linux_7",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:7"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 7"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 8",
								"product": {
									"name": "Red Hat Enterprise Linux 8",
									"product_id": "red_hat_enterprise_linux_8",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:8"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 8"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 9",
								"product": {
									"name": "Red Hat Enterprise Linux 9",
									"product_id": "red_hat_enterprise_linux_9",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:9"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 9"
					},
					{
						"category": "product_version",
						"name": "kernel",
						"product": {
							"name": "kernel",
							"product_id": "kernel",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/kernel?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "kernel-rt",
						"product": {
							"name": "kernel-rt",
							"product_id": "kernel-rt",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/kernel-rt?arch=src"
							}
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 6",
					"product_id": "red_hat_enterprise_linux_6:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_6"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2022-48674",
			"discovery_date": "2024-05-03T00:00:00+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"red_hat_enterprise_linux_6:kernel",
						"red_hat_enterprise_linux_7:kernel",
						"red_hat_enterprise_linux_7:kernel-rt",
						"red_hat_enterprise_linux_8:kernel",
						"red_hat_enterprise_linux_8:kernel-rt",
						"red_hat_enterprise_linux_9:kernel",
						"red_hat_enterprise_linux_9:kernel-rt"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2278937"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: fix pcluster use-after-free on UP platforms\n\nDuring stress testing with CONFIG_SMP disabled, KASAN reports as below:\n\n==================================================================\nBUG: KASAN: use-after-free in __mutex_lock+0xe5/0xc30\nRead of size 8 at addr ffff8881094223f8 by task stress/7789\n\nCPU: 0 PID: 7789 Comm: stress Not tainted 6.0.0-rc1-00002-g0d53d2e882f9 #3\nHardware name: Red Hat KVM, BIOS 0.5.1 01/01/2011\nCall Trace:\n <TASK>\n..\n __mutex_lock+0xe5/0xc30\n..\n z_erofs_do_read_page+0x8ce/0x1560\n..\n z_erofs_readahead+0x31c/0x580\n..\nFreed by task 7787\n kasan_save_stack+0x1e/0x40\n kasan_set_track+0x20/0x30\n kasan_set_free_info+0x20/0x40\n __kasan_slab_free+0x10c/0x190\n kmem_cache_free+0xed/0x380\n rcu_core+0x3d5/0xc90\n __do_softirq+0x12d/0x389\n\nLast potentially related work creation:\n kasan_save_stack+0x1e/0x40\n __kasan_record_aux_stack+0x97/0xb0\n call_rcu+0x3d/0x3f0\n erofs_shrink_workstation+0x11f/0x210\n erofs_shrink_scan+0xdc/0x170\n shrink_slab.constprop.0+0x296/0x530\n drop_slab+0x1c/0x70\n drop_caches_sysctl_handler+0x70/0x80\n proc_sys_call_handler+0x20a/0x2f0\n vfs_write+0x555/0x6c0\n ksys_write+0xbe/0x160\n do_syscall_64+0x3b/0x90\n\nThe root cause is that erofs_workgroup_unfreeze() doesn't reset to\norig_val thus it causes a race that the pcluster reuses unexpectedly\nbefore freeing.\n\nSince UP platforms are quite rare now, such path becomes unnecessary.\nLet's drop such specific-designed path directly instead.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "kernel: erofs: fix pcluster use-after-free on UP platforms",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "Red Hat Enterprise Linux is not impacted by this CVE, as the vulnerability in question does not affect the specific versions or configurations of the Linux kernel used in its distributions. This ensures that users of Red Hat Enterprise Linux are not exposed to the potential risks associated with this issue, and no further action or mitigation is necessary for systems running this operating system.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_not_affected": [
					"red_hat_enterprise_linux_6:kernel",
					"red_hat_enterprise_linux_7:kernel",
					"red_hat_enterprise_linux_7:kernel-rt",
					"red_hat_enterprise_linux_8:kernel",
					"red_hat_enterprise_linux_8:kernel-rt",
					"red_hat_enterprise_linux_9:kernel",
					"red_hat_enterprise_linux_9:kernel-rt"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2022-48674"
				},
				{
					"category": "external",
					"summary": "RHBZ#2278937",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2278937"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2022-48674",
					"url": "https://www.cve.org/CVERecord?id=CVE-2022-48674"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-48674",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2022-48674"
				},
				{
					"category": "external",
					"summary": "https://lore.kernel.org/linux-cve-announce/2024050318-CVE-2022-48674-b876@gregkh/T",
					"url": "https://lore.kernel.org/linux-cve-announce/2024050318-CVE-2022-48674-b876@gregkh/T"
				}
			],
			"release_date": "2024-05-03T00:00:00+00:00",
			"remediations": [
				{
					"category": "workaround",
					"details": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
					"product_ids": [
						"red_hat_enterprise_linux_6:kernel",
						"red_hat_enterprise_linux_7:kernel",
						"red_hat_enterprise_linux_7:kernel-rt",
						"red_hat_enterprise_linux_8:kernel",
						"red_hat_enterprise_linux_8:kernel-rt",
						"red_hat_enterprise_linux_9:kernel",
						"red_hat_enterprise_linux_9:kernel-rt"
					]
				}
			],
			"title": "kernel: erofs: fix pcluster use-after-free on UP platforms"
		}
	]
}
