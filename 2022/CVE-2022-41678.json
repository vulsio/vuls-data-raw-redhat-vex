{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "moderate"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright © Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/beta/vex/2022/cve-2022-41678.json"
			}
		],
		"title": "Apache ActiveMQ: Deserialization vulnerability on Jolokia that allows authenticated users to perform RCE",
		"tracking": {
			"current_release_date": "2024-03-06T07:13:48+00:00",
			"generator": {
				"date": "2024-03-06T07:13:48+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.27.1"
				}
			},
			"id": "CVE-2022-41678",
			"initial_release_date": "2022-01-01T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2022-01-01T00:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-02-11T18:28:04+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-03-06T07:13:48+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"category": "product_name",
						"name": "A-MQ Clients 2",
						"product": {
							"name": "A-MQ Clients 2",
							"product_id": "a-mq_clients_2",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:a_mq_clients:2"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat build of Apache Camel 4.0 for Spring Boot",
						"product": {
							"name": "Red Hat build of Apache Camel 4.0 for Spring Boot",
							"product_id": "red_hat_build_of_apache_camel_4.0_for_spring_boot",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:camel_spring_boot:4"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat build of OptaPlanner 8",
						"product": {
							"name": "Red Hat build of OptaPlanner 8",
							"product_id": "red_hat_build_of_optaplanner_8",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:optaplanner:::el6"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Data Grid 8",
						"product": {
							"name": "Red Hat Data Grid 8",
							"product_id": "red_hat_data_grid_8",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_data_grid:8"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Integration Camel K",
						"product": {
							"name": "Red Hat Integration Camel K",
							"product_id": "red_hat_integration_camel_k",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:integration:1"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Data Grid 7",
						"product": {
							"name": "Red Hat JBoss Data Grid 7",
							"product_id": "red_hat_jboss_data_grid_7",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_data_grid:7"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Enterprise Application Platform 7",
						"product": {
							"name": "Red Hat JBoss Enterprise Application Platform 7",
							"product_id": "red_hat_jboss_enterprise_application_platform_7",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Enterprise Application Platform 8",
						"product": {
							"name": "Red Hat JBoss Enterprise Application Platform 8",
							"product_id": "red_hat_jboss_enterprise_application_platform_8",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Fuse 6",
						"product": {
							"name": "Red Hat JBoss Fuse 6",
							"product_id": "red_hat_jboss_fuse_6",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_fuse:6"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Fuse 7",
						"product": {
							"name": "Red Hat JBoss Fuse 7",
							"product_id": "red_hat_jboss_fuse_7",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_fuse:7"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Fuse Service Works 6",
						"product": {
							"name": "Red Hat JBoss Fuse Service Works 6",
							"product_id": "red_hat_jboss_fuse_service_works_6",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Process Automation 7",
						"product": {
							"name": "Red Hat Process Automation 7",
							"product_id": "red_hat_process_automation_7",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Single Sign-On 7",
						"product": {
							"name": "Red Hat Single Sign-On 7",
							"product_id": "red_hat_single_sign-on_7",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
							}
						}
					},
					{
						"category": "product_version",
						"name": "activemq",
						"product": {
							"name": "activemq",
							"product_id": "activemq"
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of A-MQ Clients 2",
					"product_id": "a-mq_clients_2:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "a-mq_clients_2"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat build of Apache Camel 4.0 for Spring Boot",
					"product_id": "red_hat_build_of_apache_camel_4.0_for_spring_boot:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_build_of_apache_camel_4.0_for_spring_boot"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat build of OptaPlanner 8",
					"product_id": "red_hat_build_of_optaplanner_8:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_build_of_optaplanner_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat Data Grid 8",
					"product_id": "red_hat_data_grid_8:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_data_grid_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat Integration Camel K",
					"product_id": "red_hat_integration_camel_k:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_integration_camel_k"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat JBoss Data Grid 7",
					"product_id": "red_hat_jboss_data_grid_7:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_jboss_data_grid_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat JBoss Enterprise Application Platform 7",
					"product_id": "red_hat_jboss_enterprise_application_platform_7:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_jboss_enterprise_application_platform_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat JBoss Enterprise Application Platform 8",
					"product_id": "red_hat_jboss_enterprise_application_platform_8:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_jboss_enterprise_application_platform_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat JBoss Fuse 6",
					"product_id": "red_hat_jboss_fuse_6:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_jboss_fuse_6"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat JBoss Fuse 7",
					"product_id": "red_hat_jboss_fuse_7:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_jboss_fuse_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat JBoss Fuse Service Works 6",
					"product_id": "red_hat_jboss_fuse_service_works_6:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_jboss_fuse_service_works_6"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat Process Automation 7",
					"product_id": "red_hat_process_automation_7:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_process_automation_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "activemq as a component of Red Hat Single Sign-On 7",
					"product_id": "red_hat_single_sign-on_7:activemq"
				},
				"product_reference": "activemq",
				"relates_to_product_reference": "red_hat_single_sign-on_7"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2022-41678",
			"cwe": {
				"id": "CWE-502",
				"name": "Deserialization of Untrusted Data"
			},
			"discovery_date": "2023-11-30T00:00:00+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"a-mq_clients_2:activemq",
						"red_hat_build_of_optaplanner_8:activemq",
						"red_hat_data_grid_8:activemq",
						"red_hat_integration_camel_k:activemq",
						"red_hat_single_sign-on_7:activemq"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2252185"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "Once an user is authenticated on Jolokia, he can potentially trigger arbitrary code execution. \n\nIn details, in ActiveMQ configurations, jetty allows\norg.jolokia.http.AgentServlet to handler request to /api/jolokia\n\norg.jolokia.http.HttpRequestHandler#handlePostRequest is able to\ncreate JmxRequest through JSONObject. And calls to\norg.jolokia.http.HttpRequestHandler#executeRequest.\n\nInto deeper calling stacks,\norg.jolokia.handler.ExecHandler#doHandleRequest is able to invoke\nthrough refection.\n\nAnd then, RCE is able to be achieved via\njdk.management.jfr.FlightRecorderMXBeanImpl which exists on Java version above 11.\n\n1 Call newRecording.\n\n2 Call setConfiguration. And a webshell data hides in it.\n\n3 Call startRecording.\n\n4 Call copyTo method. The webshell will be written to a .jsp file.\n\nThe mitigation is to restrict (by default) the actions authorized on Jolokia, or disable Jolokia.\nA more restrictive Jolokia configuration has been defined in default ActiveMQ distribution. We encourage users to upgrade to ActiveMQ distributions version including updated Jolokia configuration: 5.16.6, 5.17.4, 5.18.0, 6.0.0.\n",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "Apache ActiveMQ: Deserialization vulnerability on Jolokia that allows authenticated users to perform RCE",
					"title": "Vulnerability summary"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_affected": [
					"red_hat_build_of_apache_camel_4.0_for_spring_boot:activemq",
					"red_hat_jboss_data_grid_7:activemq",
					"red_hat_jboss_enterprise_application_platform_7:activemq",
					"red_hat_jboss_enterprise_application_platform_8:activemq",
					"red_hat_jboss_fuse_6:activemq",
					"red_hat_jboss_fuse_7:activemq",
					"red_hat_jboss_fuse_service_works_6:activemq",
					"red_hat_process_automation_7:activemq"
				],
				"known_not_affected": [
					"a-mq_clients_2:activemq",
					"red_hat_build_of_optaplanner_8:activemq",
					"red_hat_data_grid_8:activemq",
					"red_hat_integration_camel_k:activemq",
					"red_hat_single_sign-on_7:activemq"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2022-41678"
				},
				{
					"category": "external",
					"summary": "RHBZ#2252185",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2252185"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2022-41678",
					"url": "https://www.cve.org/CVERecord?id=CVE-2022-41678"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-41678",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2022-41678"
				}
			],
			"release_date": "2023-11-28T00:00:00+00:00",
			"remediations": [
				{
					"category": "no_fix_planned",
					"details": "Out of support scope",
					"product_ids": [
						"red_hat_jboss_data_grid_7:activemq",
						"red_hat_jboss_fuse_6:activemq",
						"red_hat_jboss_fuse_service_works_6:activemq",
						"red_hat_process_automation_7:activemq"
					]
				},
				{
					"category": "no_fix_planned",
					"details": "Will not fix",
					"product_ids": [
						"red_hat_jboss_enterprise_application_platform_7:activemq",
						"red_hat_jboss_enterprise_application_platform_8:activemq"
					]
				},
				{
					"category": "none_available",
					"details": "Affected",
					"product_ids": [
						"red_hat_build_of_apache_camel_4.0_for_spring_boot:activemq",
						"red_hat_jboss_fuse_7:activemq"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "LOW",
						"attackVector": "NETWORK",
						"availabilityImpact": "HIGH",
						"baseScore": 8.8,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"privilegesRequired": "LOW",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"red_hat_build_of_apache_camel_4.0_for_spring_boot:activemq",
						"red_hat_jboss_data_grid_7:activemq",
						"red_hat_jboss_enterprise_application_platform_7:activemq",
						"red_hat_jboss_enterprise_application_platform_8:activemq",
						"red_hat_jboss_fuse_6:activemq",
						"red_hat_jboss_fuse_7:activemq",
						"red_hat_jboss_fuse_service_works_6:activemq",
						"red_hat_process_automation_7:activemq"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"details": "Moderate",
					"product_ids": [
						"red_hat_build_of_apache_camel_4.0_for_spring_boot:activemq",
						"red_hat_jboss_data_grid_7:activemq",
						"red_hat_jboss_enterprise_application_platform_7:activemq",
						"red_hat_jboss_enterprise_application_platform_8:activemq",
						"red_hat_jboss_fuse_6:activemq",
						"red_hat_jboss_fuse_7:activemq",
						"red_hat_jboss_fuse_service_works_6:activemq",
						"red_hat_process_automation_7:activemq"
					]
				}
			],
			"title": "Apache ActiveMQ: Deserialization vulnerability on Jolokia that allows authenticated users to perform RCE"
		}
	]
}
