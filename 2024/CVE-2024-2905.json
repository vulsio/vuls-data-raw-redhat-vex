{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "moderate"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright © Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/beta/vex/2024/cve-2024-2905.json"
			}
		],
		"title": "rpm-ostree: world-readable /etc/shadow file",
		"tracking": {
			"current_release_date": "2024-04-09T11:51:22+00:00",
			"generator": {
				"date": "2024-04-09T11:51:22+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.28.1"
				}
			},
			"id": "CVE-2024-2905",
			"initial_release_date": "2024-04-09T11:00:00+00:00",
			"revision_history": [
				{
					"date": "2024-04-09T11:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-04-09T11:51:09.300563+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-04-09T11:51:22+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"category": "product_name",
						"name": "Red Hat Enterprise Linux 8",
						"product": {
							"name": "Red Hat Enterprise Linux 8",
							"product_id": "red_hat_enterprise_linux_8",
							"product_identification_helper": {
								"cpe": "cpe:/o:redhat:enterprise_linux:8"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Enterprise Linux 9",
						"product": {
							"name": "Red Hat Enterprise Linux 9",
							"product_id": "red_hat_enterprise_linux_9",
							"product_identification_helper": {
								"cpe": "cpe:/o:redhat:enterprise_linux:9"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat OpenShift Container Platform 4",
						"product": {
							"name": "Red Hat OpenShift Container Platform 4",
							"product_id": "red_hat_openshift_container_platform_4",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:openshift:4"
							}
						}
					},
					{
						"category": "product_version",
						"name": "rpm-ostree",
						"product": {
							"name": "rpm-ostree",
							"product_id": "rpm-ostree"
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rpm-ostree as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:rpm-ostree"
				},
				"product_reference": "rpm-ostree",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rpm-ostree as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:rpm-ostree"
				},
				"product_reference": "rpm-ostree",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rpm-ostree as a component of Red Hat OpenShift Container Platform 4",
					"product_id": "red_hat_openshift_container_platform_4:rpm-ostree"
				},
				"product_reference": "rpm-ostree",
				"relates_to_product_reference": "red_hat_openshift_container_platform_4"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2024-2905",
			"cwe": {
				"id": "CWE-732",
				"name": "Incorrect Permission Assignment for Critical Resource"
			},
			"discovery_date": "2024-03-26T00:00:00+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"red_hat_enterprise_linux_8:rpm-ostree"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2271585"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "A security vulnerability has been discovered within rpm-ostree, pertaining to the /etc/shadow file in default builds having the world-readable bit enabled. This issue arises from the default permissions being set at a higher level than recommended, potentially exposing sensitive authentication data to unauthorized access.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "rpm-ostree: world-readable /etc/shadow file",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "This vulnerability lets local, unconfined applications read the hashed password for all users of the system from those files. To gain further access to the system, those hashed passwords need to be brute-forced to discover the real passwords that may be used to authenticate as a more privileged user on the system, for example over SSH.\n\nOn systems with SELinux enabled and in enforcing mode, access to those files is limited to unconfined (usually interactive) users, unconfined systemd services and privileged containers. Confined daemons, users and containers are not able to access them.\n\n\nOnly OpenShift clusters installed on OCP version 4.14 and later are affected.\nOpenShift Clusters installed on previous OCP releases or updated to 4.14 and later are not affected, because /etc/shadow is usually “locally modified” and the local version remains.\nClusters with no passwords set for any users (i.e. only SSH keys were used; the OpenShift default) are not impacted by this vulnerability even though it is present on the node.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_affected": [
					"red_hat_enterprise_linux_9:rpm-ostree",
					"red_hat_openshift_container_platform_4:rpm-ostree"
				],
				"known_not_affected": [
					"red_hat_enterprise_linux_8:rpm-ostree"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2024-2905"
				},
				{
					"category": "external",
					"summary": "RHBZ#2271585",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2271585"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2024-2905",
					"url": "https://www.cve.org/CVERecord?id=CVE-2024-2905"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-2905",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2024-2905"
				},
				{
					"category": "external",
					"summary": "https://github.com/coreos/rpm-ostree/security/advisories/GHSA-2m76-cwhg-7wv6",
					"url": "https://github.com/coreos/rpm-ostree/security/advisories/GHSA-2m76-cwhg-7wv6"
				}
			],
			"release_date": "2024-04-09T11:00:00+00:00",
			"remediations": [
				{
					"category": "workaround",
					"details": "If you need to apply the fix immediately, you can run the following commands, using credentials that have administrator access to an OpenShift cluster:\n\n# List current permissions for all nodes\nfor node in $( oc get nodes -oname) ; do echo $node ; oc debug $node -- bash -c \"ls -alhZ /host/etc/*shadow*\"; done\n\n# Set correct permissions\nfor node in $( oc get nodes -oname) ; do echo $node ; oc debug $node -- chmod --verbose 0000 /host/etc/shadow /host/etc/gshadow /host/etc/shadow- /host/etc/gshadow-; done\n\nAs a precaution, we recommend rotating all user credentials stored in those files.",
					"product_ids": [
						"red_hat_enterprise_linux_8:rpm-ostree",
						"red_hat_enterprise_linux_9:rpm-ostree",
						"red_hat_openshift_container_platform_4:rpm-ostree"
					]
				},
				{
					"category": "none_available",
					"details": "Affected",
					"product_ids": [
						"red_hat_enterprise_linux_9:rpm-ostree",
						"red_hat_openshift_container_platform_4:rpm-ostree"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "LOW",
						"attackVector": "LOCAL",
						"availabilityImpact": "NONE",
						"baseScore": 6.2,
						"baseSeverity": "MEDIUM",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "NONE",
						"privilegesRequired": "NONE",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
						"version": "3.1"
					},
					"products": [
						"red_hat_enterprise_linux_9:rpm-ostree",
						"red_hat_openshift_container_platform_4:rpm-ostree"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"details": "Moderate",
					"product_ids": [
						"red_hat_enterprise_linux_9:rpm-ostree",
						"red_hat_openshift_container_platform_4:rpm-ostree"
					]
				}
			],
			"title": "rpm-ostree: world-readable /etc/shadow file"
		}
	]
}
