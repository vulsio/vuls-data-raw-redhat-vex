{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "Important"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-52811.json"
			}
		],
		"title": "ngtcp2: Acks not validated before logged to qlog leads to buffer overflow in ngtcp2",
		"tracking": {
			"current_release_date": "2024-11-26T06:45:10+00:00",
			"generator": {
				"date": "2024-11-26T06:45:10+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "4.2.1"
				}
			},
			"id": "CVE-2024-52811",
			"initial_release_date": "2024-11-25T18:55:36.279000+00:00",
			"revision_history": [
				{
					"date": "2024-11-25T18:55:36.279000+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-11-25T21:24:50.706616+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-11-26T06:45:10+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 8",
								"product": {
									"name": "Red Hat Enterprise Linux 8",
									"product_id": "red_hat_enterprise_linux_8",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:8"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 8"
					},
					{
						"category": "product_version",
						"name": "nodejs:18/nodejs",
						"product": {
							"name": "nodejs:18/nodejs",
							"product_id": "nodejs:18/nodejs",
							"product_identification_helper": {
								"purl": "pkg:rpmmod/redhat/nodejs:18/nodejs"
							}
						}
					},
					{
						"category": "product_version",
						"name": "nodejs:20/nodejs",
						"product": {
							"name": "nodejs:20/nodejs",
							"product_id": "nodejs:20/nodejs",
							"product_identification_helper": {
								"purl": "pkg:rpmmod/redhat/nodejs:20/nodejs"
							}
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "nodejs:18/nodejs as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:nodejs:18/nodejs"
				},
				"product_reference": "nodejs:18/nodejs",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "nodejs:20/nodejs as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:nodejs:20/nodejs"
				},
				"product_reference": "nodejs:20/nodejs",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2024-52811",
			"cwe": {
				"id": "CWE-670",
				"name": "Always-Incorrect Control Flow Implementation"
			},
			"discovery_date": "2024-11-25T19:00:43.970041+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"red_hat_enterprise_linux_8:nodejs:18/nodejs",
						"red_hat_enterprise_linux_8:nodejs:20/nodejs"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2328752"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "The ngtcp2 project is an effort to implement IETF QUIC protocol in C. In affected versions acks are not validated before being written to the qlog leading to a buffer overflow. In `ngtcp2_conn::conn_recv_pkt` for an ACK, there was new logic that got added to skip `conn_recv_ack` if an ack has already been processed in the payload. However, this causes us to also skip `ngtcp2_pkt_validate_ack`. The ack which was skipped still got written to qlog. The bug occurs in `ngtcp2_qlog::write_ack_frame`. It is now possible to reach this code with an invalid ack, suppose `largest_ack=0` and `first_ack_range=15`. Subtracting `largest_ack - first_ack_range` will lead to an integer underflow which is 20 chars long. However, the ngtcp2 qlog code assumes the number written is a signed integer and only accounts for 19 characters of overhead (see `NGTCP2_QLOG_ACK_FRAME_RANGE_OVERHEAD`). Therefore, we overwrite the buffer causing a heap overflow. This is high priority and could potentially impact many users if they enable qlog. qlog is disabled by default. Due to its overhead, it is most likely used for debugging purpose, but the actual use is unknown. ngtcp2 v1.9.1 fixes the bug and users are advised to upgrade. Users unable to upgrade should not turn on qlog.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "ngtcp2: Acks not validated before logged to qlog leads to buffer overflow in ngtcp2",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "Red Hat does not ship an affected version of ngtcp2. Additionally, this vulnerability impacts systems where qlog is enabled. By default, qlog is disabled.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_not_affected": [
					"red_hat_enterprise_linux_8:nodejs:18/nodejs",
					"red_hat_enterprise_linux_8:nodejs:20/nodejs"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2024-52811"
				},
				{
					"category": "external",
					"summary": "RHBZ#2328752",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2328752"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2024-52811",
					"url": "https://www.cve.org/CVERecord?id=CVE-2024-52811"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-52811",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2024-52811"
				},
				{
					"category": "external",
					"summary": "https://github.com/ngtcp2/ngtcp2/commit/44b662bd139c23fee1703bf256c13349e2e624a1",
					"url": "https://github.com/ngtcp2/ngtcp2/commit/44b662bd139c23fee1703bf256c13349e2e624a1"
				},
				{
					"category": "external",
					"summary": "https://github.com/ngtcp2/ngtcp2/commit/e550c1a414318d0f3f01fca1a621ae0b0428ca15",
					"url": "https://github.com/ngtcp2/ngtcp2/commit/e550c1a414318d0f3f01fca1a621ae0b0428ca15"
				},
				{
					"category": "external",
					"summary": "https://github.com/ngtcp2/ngtcp2/security/advisories/GHSA-4gmv-gf46-r4g5",
					"url": "https://github.com/ngtcp2/ngtcp2/security/advisories/GHSA-4gmv-gf46-r4g5"
				}
			],
			"release_date": "2024-11-25T18:55:36.279000+00:00",
			"title": "ngtcp2: Acks not validated before logged to qlog leads to buffer overflow in ngtcp2"
		}
	]
}
