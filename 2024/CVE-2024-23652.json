{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "important"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/v2/vex/2024/cve-2024-23652.json"
			}
		],
		"title": "moby/buildkit: possible host system access from mount stub cleaner",
		"tracking": {
			"current_release_date": "2024-08-02T13:14:51+00:00",
			"generator": {
				"date": "2024-08-02T13:14:51+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.31.1"
				}
			},
			"id": "CVE-2024-23652",
			"initial_release_date": "2024-01-31T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2024-01-31T00:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-06-09T17:51:31+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-08-02T13:14:51+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "OpenShift Developer Tools and Services",
								"product": {
									"name": "OpenShift Developer Tools and Services",
									"product_id": "openshift_developer_tools_and_services",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:ocp_tools"
									}
								}
							}
						],
						"category": "product_family",
						"name": "OpenShift Developer Tools and Services"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "OpenShift Serverless",
								"product": {
									"name": "OpenShift Serverless",
									"product_id": "openshift_serverless",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:serverless:1"
									}
								}
							}
						],
						"category": "product_family",
						"name": "OpenShift Serverless"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "OpenShift Service Mesh 2",
								"product": {
									"name": "OpenShift Service Mesh 2",
									"product_id": "openshift_service_mesh_2",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:service_mesh:2"
									}
								}
							}
						],
						"category": "product_family",
						"name": "OpenShift Service Mesh 2"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Ansible Automation Platform 1.2",
								"product": {
									"name": "Red Hat Ansible Automation Platform 1.2",
									"product_id": "red_hat_ansible_automation_platform_1.2",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:ansible_automation_platform"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Ansible Automation Platform 1.2"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Ansible Automation Platform 2",
								"product": {
									"name": "Red Hat Ansible Automation Platform 2",
									"product_id": "red_hat_ansible_automation_platform_2",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:ansible_automation_platform:2"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Ansible Automation Platform 2"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 7",
								"product": {
									"name": "Red Hat Enterprise Linux 7",
									"product_id": "red_hat_enterprise_linux_7",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:7"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 7"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 8",
								"product": {
									"name": "Red Hat Enterprise Linux 8",
									"product_id": "red_hat_enterprise_linux_8",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:8"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 8"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 9",
								"product": {
									"name": "Red Hat Enterprise Linux 9",
									"product_id": "red_hat_enterprise_linux_9",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:9"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 9"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat OpenShift Container Platform 4",
								"product": {
									"name": "Red Hat OpenShift Container Platform 4",
									"product_id": "red_hat_openshift_container_platform_4",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:openshift:4"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat OpenShift Container Platform 4"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat OpenShift Dev Spaces",
								"product": {
									"name": "Red Hat OpenShift Dev Spaces",
									"product_id": "red_hat_openshift_dev_spaces",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:openshift_devspaces:3::el8"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat OpenShift Dev Spaces"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Quay 3",
								"product": {
									"name": "Red Hat Quay 3",
									"product_id": "red_hat_quay_3",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:quay:3"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Quay 3"
					},
					{
						"category": "product_version",
						"name": "odo",
						"product": {
							"name": "odo",
							"product_id": "odo",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/odo?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "openshift-serverless-1/client-kn-rhel8",
						"product": {
							"name": "openshift-serverless-1/client-kn-rhel8",
							"product_id": "openshift-serverless-1/client-kn-rhel8"
						}
					},
					{
						"category": "product_version",
						"name": "openshift-serverless-clients",
						"product": {
							"name": "openshift-serverless-clients",
							"product_id": "openshift-serverless-clients"
						}
					},
					{
						"category": "product_version",
						"name": "openshift-service-mesh/istio-cni-rhel8",
						"product": {
							"name": "openshift-service-mesh/istio-cni-rhel8",
							"product_id": "openshift-service-mesh/istio-cni-rhel8",
							"product_identification_helper": {
								"purl": "pkg:oci/openshift-service-mesh/istio-cni-rhel8"
							}
						}
					},
					{
						"category": "product_version",
						"name": "openshift-clients",
						"product": {
							"name": "openshift-clients",
							"product_id": "openshift-clients",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/openshift-clients?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "buildah",
						"product": {
							"name": "buildah",
							"product_id": "buildah",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/buildah?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "container-tools:4.0/buildah",
						"product": {
							"name": "container-tools:4.0/buildah",
							"product_id": "container-tools:4.0/buildah",
							"product_identification_helper": {
								"purl": "pkg:rpmmod/redhat/container-tools:4.0/buildah"
							}
						}
					},
					{
						"category": "product_version",
						"name": "container-tools:rhel8/buildah",
						"product": {
							"name": "container-tools:rhel8/buildah",
							"product_id": "container-tools:rhel8/buildah",
							"product_identification_helper": {
								"purl": "pkg:rpmmod/redhat/container-tools:rhel8/buildah"
							}
						}
					},
					{
						"category": "product_version",
						"name": "container-tools:rhel8/podman",
						"product": {
							"name": "container-tools:rhel8/podman",
							"product_id": "container-tools:rhel8/podman",
							"product_identification_helper": {
								"purl": "pkg:rpmmod/redhat/container-tools:rhel8/podman"
							}
						}
					},
					{
						"category": "product_version",
						"name": "podman",
						"product": {
							"name": "podman",
							"product_id": "podman",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/podman?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "devspaces/traefik-rhel8",
						"product": {
							"name": "devspaces/traefik-rhel8",
							"product_id": "devspaces/traefik-rhel8",
							"product_identification_helper": {
								"purl": "pkg:oci/devspaces/traefik-rhel8"
							}
						}
					},
					{
						"category": "product_version",
						"name": "quay/quay-builder-rhel8",
						"product": {
							"name": "quay/quay-builder-rhel8",
							"product_id": "quay/quay-builder-rhel8",
							"product_identification_helper": {
								"purl": "pkg:oci/quay/quay-builder-rhel8"
							}
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "odo as a component of OpenShift Developer Tools and Services",
					"product_id": "openshift_developer_tools_and_services:odo"
				},
				"product_reference": "odo",
				"relates_to_product_reference": "openshift_developer_tools_and_services"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "openshift-serverless-1/client-kn-rhel8 as a component of OpenShift Serverless",
					"product_id": "openshift_serverless:openshift-serverless-1/client-kn-rhel8"
				},
				"product_reference": "openshift-serverless-1/client-kn-rhel8",
				"relates_to_product_reference": "openshift_serverless"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "openshift-serverless-clients as a component of OpenShift Serverless",
					"product_id": "openshift_serverless:openshift-serverless-clients"
				},
				"product_reference": "openshift-serverless-clients",
				"relates_to_product_reference": "openshift_serverless"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "openshift-service-mesh/istio-cni-rhel8 as a component of OpenShift Service Mesh 2",
					"product_id": "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8"
				},
				"product_reference": "openshift-service-mesh/istio-cni-rhel8",
				"relates_to_product_reference": "openshift_service_mesh_2"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "openshift-clients as a component of Red Hat Ansible Automation Platform 1.2",
					"product_id": "red_hat_ansible_automation_platform_1.2:openshift-clients"
				},
				"product_reference": "openshift-clients",
				"relates_to_product_reference": "red_hat_ansible_automation_platform_1.2"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "openshift-clients as a component of Red Hat Ansible Automation Platform 2",
					"product_id": "red_hat_ansible_automation_platform_2:openshift-clients"
				},
				"product_reference": "openshift-clients",
				"relates_to_product_reference": "red_hat_ansible_automation_platform_2"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "buildah as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:buildah"
				},
				"product_reference": "buildah",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "container-tools:4.0/buildah as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:container-tools:4.0/buildah"
				},
				"product_reference": "container-tools:4.0/buildah",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "container-tools:rhel8/buildah as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:container-tools:rhel8/buildah"
				},
				"product_reference": "container-tools:rhel8/buildah",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "container-tools:rhel8/podman as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:container-tools:rhel8/podman"
				},
				"product_reference": "container-tools:rhel8/podman",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "buildah as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:buildah"
				},
				"product_reference": "buildah",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "podman as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:podman"
				},
				"product_reference": "podman",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "buildah as a component of Red Hat OpenShift Container Platform 4",
					"product_id": "red_hat_openshift_container_platform_4:buildah"
				},
				"product_reference": "buildah",
				"relates_to_product_reference": "red_hat_openshift_container_platform_4"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "openshift-clients as a component of Red Hat OpenShift Container Platform 4",
					"product_id": "red_hat_openshift_container_platform_4:openshift-clients"
				},
				"product_reference": "openshift-clients",
				"relates_to_product_reference": "red_hat_openshift_container_platform_4"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "devspaces/traefik-rhel8 as a component of Red Hat OpenShift Dev Spaces",
					"product_id": "red_hat_openshift_dev_spaces:devspaces/traefik-rhel8"
				},
				"product_reference": "devspaces/traefik-rhel8",
				"relates_to_product_reference": "red_hat_openshift_dev_spaces"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "quay/quay-builder-rhel8 as a component of Red Hat Quay 3",
					"product_id": "red_hat_quay_3:quay/quay-builder-rhel8"
				},
				"product_reference": "quay/quay-builder-rhel8",
				"relates_to_product_reference": "red_hat_quay_3"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2024-23652",
			"cwe": {
				"id": "CWE-22",
				"name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
			},
			"discovery_date": "2024-02-01T00:00:00+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"openshift_developer_tools_and_services:odo",
						"openshift_serverless:openshift-serverless-1/client-kn-rhel8",
						"openshift_serverless:openshift-serverless-clients",
						"openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
						"red_hat_ansible_automation_platform_1.2:openshift-clients",
						"red_hat_ansible_automation_platform_2:openshift-clients",
						"red_hat_enterprise_linux_8:container-tools:4.0/buildah",
						"red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
						"red_hat_enterprise_linux_8:container-tools:rhel8/podman",
						"red_hat_enterprise_linux_9:buildah",
						"red_hat_enterprise_linux_9:podman",
						"red_hat_openshift_container_platform_4:buildah",
						"red_hat_openshift_container_platform_4:openshift-clients"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2262225"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "A vulnerability was found in the Moby Builder Toolkit, which arose from BuildKit's attempts to clean up temporarily added directories after use. A malicious BuildKit frontend or Dockerfile using RUN --mount could deceive the feature responsible for removing empty files created for the mount points, potentially leading to removing a file outside the container and affecting the host system. Successful exploitation of this issue may result in the arbitrary deletion of files and directories on the underlying host OS when building an image using a malicious Dockerfile or upstream image (for example, when using FROM).",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "moby/buildkit: possible host system access from mount stub cleaner",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "The following are preconditions for exploiting this vulnerability:\n* A container is built using a Dockerfile\n        OR\n* A BuildKit frontend is invoked with the RUN --mount command\n\n\nAdditionally, for the cleanup operations to impact the host file system the parent of the target directory needs to be replaced with a symbolic link during the build container's lifetime. For these reasons, this flaw was rated with an important severity.\n\nSome offerings (Notably Red Hat Enterprise Linux and Red Hat OpenShift Container Platform) include functionality that mimics certain BuildKit features via the Buildah package. However, within Buildah these temporary mount targets are consistently removed by a subprocess running in a chroot; this effectively prevents exploitation of this vulnerability. Therefore the impact for offerings which include BuildKit via Buildah are rated Low.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_affected": [
					"red_hat_enterprise_linux_7:buildah",
					"red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
					"red_hat_quay_3:quay/quay-builder-rhel8"
				],
				"known_not_affected": [
					"openshift_developer_tools_and_services:odo",
					"openshift_serverless:openshift-serverless-1/client-kn-rhel8",
					"openshift_serverless:openshift-serverless-clients",
					"openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
					"red_hat_ansible_automation_platform_1.2:openshift-clients",
					"red_hat_ansible_automation_platform_2:openshift-clients",
					"red_hat_enterprise_linux_8:container-tools:4.0/buildah",
					"red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
					"red_hat_enterprise_linux_8:container-tools:rhel8/podman",
					"red_hat_enterprise_linux_9:buildah",
					"red_hat_enterprise_linux_9:podman",
					"red_hat_openshift_container_platform_4:buildah",
					"red_hat_openshift_container_platform_4:openshift-clients"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2024-23652"
				},
				{
					"category": "external",
					"summary": "RHBZ#2262225",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2262225"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2024-23652",
					"url": "https://www.cve.org/CVERecord?id=CVE-2024-23652"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-23652",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2024-23652"
				},
				{
					"category": "external",
					"summary": "https://github.com/moby/buildkit/pull/4603",
					"url": "https://github.com/moby/buildkit/pull/4603"
				},
				{
					"category": "external",
					"summary": "https://github.com/moby/buildkit/security/advisories/GHSA-4v98-7qmw-rqr8",
					"url": "https://github.com/moby/buildkit/security/advisories/GHSA-4v98-7qmw-rqr8"
				},
				{
					"category": "external",
					"summary": "https://snyk.io/blog/cve-2024-23652-buildkit-build-time-container-teardown-arbitrary-delete/",
					"url": "https://snyk.io/blog/cve-2024-23652-buildkit-build-time-container-teardown-arbitrary-delete/"
				}
			],
			"release_date": "2024-01-31T00:00:00+00:00",
			"remediations": [
				{
					"category": "workaround",
					"details": "Do not use BuildKit frontends or Dockerfiles from untrusted sources.",
					"product_ids": [
						"openshift_developer_tools_and_services:odo",
						"openshift_serverless:openshift-serverless-1/client-kn-rhel8",
						"openshift_serverless:openshift-serverless-clients",
						"openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
						"red_hat_ansible_automation_platform_1.2:openshift-clients",
						"red_hat_ansible_automation_platform_2:openshift-clients",
						"red_hat_enterprise_linux_7:buildah",
						"red_hat_enterprise_linux_8:container-tools:4.0/buildah",
						"red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
						"red_hat_enterprise_linux_8:container-tools:rhel8/podman",
						"red_hat_enterprise_linux_9:buildah",
						"red_hat_enterprise_linux_9:podman",
						"red_hat_openshift_container_platform_4:buildah",
						"red_hat_openshift_container_platform_4:openshift-clients",
						"red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
						"red_hat_quay_3:quay/quay-builder-rhel8"
					]
				},
				{
					"category": "no_fix_planned",
					"details": "Out of support scope",
					"product_ids": [
						"red_hat_enterprise_linux_7:buildah"
					]
				},
				{
					"category": "none_available",
					"details": "Affected",
					"product_ids": [
						"red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
						"red_hat_quay_3:quay/quay-builder-rhel8"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "HIGH",
						"attackVector": "LOCAL",
						"availabilityImpact": "HIGH",
						"baseScore": 7.8,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "NONE",
						"integrityImpact": "HIGH",
						"privilegesRequired": "NONE",
						"scope": "CHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"red_hat_enterprise_linux_7:buildah",
						"red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
						"red_hat_quay_3:quay/quay-builder-rhel8"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"details": "Low",
					"product_ids": [
						"red_hat_enterprise_linux_7:buildah"
					]
				},
				{
					"category": "impact",
					"details": "Important",
					"product_ids": [
						"red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
						"red_hat_quay_3:quay/quay-builder-rhel8"
					]
				}
			],
			"title": "moby/buildkit: possible host system access from mount stub cleaner"
		}
	]
}
