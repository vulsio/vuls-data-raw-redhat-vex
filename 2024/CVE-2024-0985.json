{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "important"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/beta/vex/2024/cve-2024-0985.json"
			}
		],
		"title": "postgresql: non-owner 'REFRESH MATERIALIZED VIEW CONCURRENTLY' executes arbitrary SQL",
		"tracking": {
			"current_release_date": "2024-02-13T06:59:55+00:00",
			"generator": {
				"date": "2024-02-13T06:59:55+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.26.3"
				}
			},
			"id": "CVE-2024-0985",
			"initial_release_date": "2024-02-08T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2024-02-08T00:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-02-13T06:55:53+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-02-13T06:59:55+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"category": "product_name",
						"name": "OpenShift Serverless",
						"product": {
							"name": "OpenShift Serverless",
							"product_id": "openshift_serverless",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:serverless:1"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat build of OptaPlanner 8",
						"product": {
							"name": "Red Hat build of OptaPlanner 8",
							"product_id": "red_hat_build_of_optaplanner_8",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:optaplanner:::el6"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat build of Quarkus",
						"product": {
							"name": "Red Hat build of Quarkus",
							"product_id": "red_hat_build_of_quarkus",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:quarkus:3"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Data Grid 8",
						"product": {
							"name": "Red Hat Data Grid 8",
							"product_id": "red_hat_data_grid_8",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_data_grid:8"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Enterprise Linux 6",
						"product": {
							"name": "Red Hat Enterprise Linux 6",
							"product_id": "red_hat_enterprise_linux_6",
							"product_identification_helper": {
								"cpe": "cpe:/o:redhat:enterprise_linux:6"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Enterprise Linux 7",
						"product": {
							"name": "Red Hat Enterprise Linux 7",
							"product_id": "red_hat_enterprise_linux_7",
							"product_identification_helper": {
								"cpe": "cpe:/o:redhat:enterprise_linux:7"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Enterprise Linux 8",
						"product": {
							"name": "Red Hat Enterprise Linux 8",
							"product_id": "red_hat_enterprise_linux_8",
							"product_identification_helper": {
								"cpe": "cpe:/o:redhat:enterprise_linux:8"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Enterprise Linux 9",
						"product": {
							"name": "Red Hat Enterprise Linux 9",
							"product_id": "red_hat_enterprise_linux_9",
							"product_identification_helper": {
								"cpe": "cpe:/o:redhat:enterprise_linux:9"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Integration Change Data Capture",
						"product": {
							"name": "Red Hat Integration Change Data Capture",
							"product_id": "red_hat_integration_change_data_capture",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:debezium:2"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Integration Service Registry",
						"product": {
							"name": "Red Hat Integration Service Registry",
							"product_id": "red_hat_integration_service_registry",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:service_registry:2"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Data Grid 7",
						"product": {
							"name": "Red Hat JBoss Data Grid 7",
							"product_id": "red_hat_jboss_data_grid_7",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_data_grid:7"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Fuse 7",
						"product": {
							"name": "Red Hat JBoss Fuse 7",
							"product_id": "red_hat_jboss_fuse_7",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_fuse:7"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat Software Collections",
						"product": {
							"name": "Red Hat Software Collections",
							"product_id": "red_hat_software_collections",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:rhel_software_collections:3"
							}
						}
					},
					{
						"category": "product_version",
						"name": "postgresql",
						"product": {
							"name": "postgresql",
							"product_id": "postgresql"
						}
					},
					{
						"category": "product_version",
						"name": "postgresql:10/postgresql",
						"product": {
							"name": "postgresql:10/postgresql",
							"product_id": "postgresql:10/postgresql"
						}
					},
					{
						"category": "product_version",
						"name": "postgresql:12/postgresql",
						"product": {
							"name": "postgresql:12/postgresql",
							"product_id": "postgresql:12/postgresql"
						}
					},
					{
						"category": "product_version",
						"name": "postgresql:13/postgresql",
						"product": {
							"name": "postgresql:13/postgresql",
							"product_id": "postgresql:13/postgresql"
						}
					},
					{
						"category": "product_version",
						"name": "postgresql:15/postgresql",
						"product": {
							"name": "postgresql:15/postgresql",
							"product_id": "postgresql:15/postgresql"
						}
					},
					{
						"category": "product_version",
						"name": "postgresql:16/postgresql",
						"product": {
							"name": "postgresql:16/postgresql",
							"product_id": "postgresql:16/postgresql"
						}
					},
					{
						"category": "product_version",
						"name": "rh-postgresql10-postgresql",
						"product": {
							"name": "rh-postgresql10-postgresql",
							"product_id": "rh-postgresql10-postgresql"
						}
					},
					{
						"category": "product_version",
						"name": "rh-postgresql12-postgresql",
						"product": {
							"name": "rh-postgresql12-postgresql",
							"product_id": "rh-postgresql12-postgresql"
						}
					},
					{
						"category": "product_version",
						"name": "rh-postgresql13-postgresql",
						"product": {
							"name": "rh-postgresql13-postgresql",
							"product_id": "rh-postgresql13-postgresql"
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of OpenShift Serverless",
					"product_id": "openshift_serverless:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "openshift_serverless"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat build of OptaPlanner 8",
					"product_id": "red_hat_build_of_optaplanner_8:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_build_of_optaplanner_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat build of Quarkus",
					"product_id": "red_hat_build_of_quarkus:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_build_of_quarkus"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat Data Grid 8",
					"product_id": "red_hat_data_grid_8:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_data_grid_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat Enterprise Linux 6",
					"product_id": "red_hat_enterprise_linux_6:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_6"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql:10/postgresql as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:postgresql:10/postgresql"
				},
				"product_reference": "postgresql:10/postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql:12/postgresql as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:postgresql:12/postgresql"
				},
				"product_reference": "postgresql:12/postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql:13/postgresql as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:postgresql:13/postgresql"
				},
				"product_reference": "postgresql:13/postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql:15/postgresql as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:postgresql:15/postgresql"
				},
				"product_reference": "postgresql:15/postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql:16/postgresql as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:postgresql:16/postgresql"
				},
				"product_reference": "postgresql:16/postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql:15/postgresql as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:postgresql:15/postgresql"
				},
				"product_reference": "postgresql:15/postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql:16/postgresql as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:postgresql:16/postgresql"
				},
				"product_reference": "postgresql:16/postgresql",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat Integration Change Data Capture",
					"product_id": "red_hat_integration_change_data_capture:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_integration_change_data_capture"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat Integration Service Registry",
					"product_id": "red_hat_integration_service_registry:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_integration_service_registry"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat JBoss Data Grid 7",
					"product_id": "red_hat_jboss_data_grid_7:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_jboss_data_grid_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "postgresql as a component of Red Hat JBoss Fuse 7",
					"product_id": "red_hat_jboss_fuse_7:postgresql"
				},
				"product_reference": "postgresql",
				"relates_to_product_reference": "red_hat_jboss_fuse_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-postgresql10-postgresql as a component of Red Hat Software Collections",
					"product_id": "red_hat_software_collections:rh-postgresql10-postgresql"
				},
				"product_reference": "rh-postgresql10-postgresql",
				"relates_to_product_reference": "red_hat_software_collections"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-postgresql12-postgresql as a component of Red Hat Software Collections",
					"product_id": "red_hat_software_collections:rh-postgresql12-postgresql"
				},
				"product_reference": "rh-postgresql12-postgresql",
				"relates_to_product_reference": "red_hat_software_collections"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-postgresql13-postgresql as a component of Red Hat Software Collections",
					"product_id": "red_hat_software_collections:rh-postgresql13-postgresql"
				},
				"product_reference": "rh-postgresql13-postgresql",
				"relates_to_product_reference": "red_hat_software_collections"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2024-0985",
			"cwe": {
				"id": "CWE-271",
				"name": "Privilege Dropping / Lowering Errors"
			},
			"discovery_date": "2024-02-08T00:00:00+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"red_hat_enterprise_linux_7:postgresql",
						"red_hat_enterprise_linux_8:postgresql:16/postgresql",
						"red_hat_enterprise_linux_9:postgresql:16/postgresql"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2263384"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "A flaw was found in PostgreSQL. A late privilege drop in REFRESH MATERIALIZED VIEW CONCURRENTLY in PostgreSQL can allow an object creator to execute arbitrary SQL functions as the command issuer. The command intends to run SQL functions as the owner of the materialized view, enabling safe refresh of untrusted materialized views. The attack requires luring the victim, a superuser or member of one of the attacker's roles, into running REFRESH MATERIALIZED VIEW CONCURRENTLY on the attacker's materialized view.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "postgresql: non-owner 'REFRESH MATERIALIZED VIEW CONCURRENTLY' executes arbitrary SQL",
					"title": "Vulnerability summary"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_affected": [
					"red_hat_enterprise_linux_6:postgresql",
					"red_hat_enterprise_linux_8:postgresql:10/postgresql",
					"red_hat_enterprise_linux_8:postgresql:12/postgresql",
					"red_hat_enterprise_linux_8:postgresql:13/postgresql",
					"red_hat_enterprise_linux_8:postgresql:15/postgresql",
					"red_hat_enterprise_linux_9:postgresql",
					"red_hat_enterprise_linux_9:postgresql:15/postgresql",
					"red_hat_software_collections:rh-postgresql10-postgresql",
					"red_hat_software_collections:rh-postgresql12-postgresql",
					"red_hat_software_collections:rh-postgresql13-postgresql"
				],
				"known_not_affected": [
					"red_hat_enterprise_linux_7:postgresql",
					"red_hat_enterprise_linux_8:postgresql:16/postgresql",
					"red_hat_enterprise_linux_9:postgresql:16/postgresql"
				],
				"under_investigation": [
					"openshift_serverless:postgresql",
					"red_hat_build_of_optaplanner_8:postgresql",
					"red_hat_build_of_quarkus:postgresql",
					"red_hat_data_grid_8:postgresql",
					"red_hat_integration_change_data_capture:postgresql",
					"red_hat_integration_service_registry:postgresql",
					"red_hat_jboss_data_grid_7:postgresql",
					"red_hat_jboss_fuse_7:postgresql"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2024-0985"
				},
				{
					"category": "external",
					"summary": "RHBZ#2263384",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2263384"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2024-0985",
					"url": "https://www.cve.org/CVERecord?id=CVE-2024-0985"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-0985",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2024-0985"
				}
			],
			"release_date": "2024-02-08T00:00:00+00:00",
			"remediations": [
				{
					"category": "no_fix_planned",
					"details": "Out of support scope",
					"product_ids": [
						"red_hat_enterprise_linux_6:postgresql"
					]
				},
				{
					"category": "none_available",
					"details": "Affected",
					"product_ids": [
						"red_hat_enterprise_linux_8:postgresql:10/postgresql",
						"red_hat_enterprise_linux_8:postgresql:12/postgresql",
						"red_hat_enterprise_linux_8:postgresql:13/postgresql",
						"red_hat_enterprise_linux_8:postgresql:15/postgresql",
						"red_hat_enterprise_linux_9:postgresql",
						"red_hat_enterprise_linux_9:postgresql:15/postgresql",
						"red_hat_software_collections:rh-postgresql10-postgresql",
						"red_hat_software_collections:rh-postgresql12-postgresql",
						"red_hat_software_collections:rh-postgresql13-postgresql"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "LOW",
						"attackVector": "NETWORK",
						"availabilityImpact": "HIGH",
						"baseScore": 8,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"privilegesRequired": "LOW",
						"scope": "UNCHANGED",
						"userInteraction": "REQUIRED",
						"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"openshift_serverless:postgresql",
						"red_hat_build_of_optaplanner_8:postgresql",
						"red_hat_build_of_quarkus:postgresql",
						"red_hat_data_grid_8:postgresql",
						"red_hat_enterprise_linux_6:postgresql",
						"red_hat_enterprise_linux_8:postgresql:10/postgresql",
						"red_hat_enterprise_linux_8:postgresql:12/postgresql",
						"red_hat_enterprise_linux_8:postgresql:13/postgresql",
						"red_hat_enterprise_linux_8:postgresql:15/postgresql",
						"red_hat_enterprise_linux_9:postgresql",
						"red_hat_enterprise_linux_9:postgresql:15/postgresql",
						"red_hat_integration_change_data_capture:postgresql",
						"red_hat_integration_service_registry:postgresql",
						"red_hat_jboss_data_grid_7:postgresql",
						"red_hat_jboss_fuse_7:postgresql",
						"red_hat_software_collections:rh-postgresql10-postgresql",
						"red_hat_software_collections:rh-postgresql12-postgresql",
						"red_hat_software_collections:rh-postgresql13-postgresql"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"details": "Important",
					"product_ids": [
						"openshift_serverless:postgresql",
						"red_hat_build_of_optaplanner_8:postgresql",
						"red_hat_build_of_quarkus:postgresql",
						"red_hat_data_grid_8:postgresql",
						"red_hat_enterprise_linux_6:postgresql",
						"red_hat_enterprise_linux_8:postgresql:10/postgresql",
						"red_hat_enterprise_linux_8:postgresql:12/postgresql",
						"red_hat_enterprise_linux_8:postgresql:13/postgresql",
						"red_hat_enterprise_linux_8:postgresql:15/postgresql",
						"red_hat_enterprise_linux_9:postgresql",
						"red_hat_enterprise_linux_9:postgresql:15/postgresql",
						"red_hat_integration_change_data_capture:postgresql",
						"red_hat_integration_service_registry:postgresql",
						"red_hat_jboss_data_grid_7:postgresql",
						"red_hat_jboss_fuse_7:postgresql",
						"red_hat_software_collections:rh-postgresql10-postgresql",
						"red_hat_software_collections:rh-postgresql12-postgresql",
						"red_hat_software_collections:rh-postgresql13-postgresql"
					]
				}
			],
			"title": "postgresql: non-owner 'REFRESH MATERIALIZED VIEW CONCURRENTLY' executes arbitrary SQL"
		}
	]
}
