{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "important"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/v2/vex/2024/cve-2024-42472.json"
			}
		],
		"title": "flatpak: Access to files outside sandbox for apps using persistent= (--persist)",
		"tracking": {
			"current_release_date": "2024-08-28T16:42:11+00:00",
			"generator": {
				"date": "2024-08-28T16:42:11+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.32.1"
				}
			},
			"id": "CVE-2024-42472",
			"initial_release_date": "2024-08-14T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2024-08-14T00:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-08-19T04:07:57+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-08-28T16:42:11+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Ansible Automation Platform 1.2",
								"product": {
									"name": "Red Hat Ansible Automation Platform 1.2",
									"product_id": "red_hat_ansible_automation_platform_1.2",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:ansible_automation_platform"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Ansible Automation Platform 1.2"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 7",
								"product": {
									"name": "Red Hat Enterprise Linux 7",
									"product_id": "red_hat_enterprise_linux_7",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:7"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 7"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 8",
								"product": {
									"name": "Red Hat Enterprise Linux 8",
									"product_id": "red_hat_enterprise_linux_8",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:8"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 8"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 9",
								"product": {
									"name": "Red Hat Enterprise Linux 9",
									"product_id": "red_hat_enterprise_linux_9",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:9"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 9"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat OpenShift Container Platform 4",
								"product": {
									"name": "Red Hat OpenShift Container Platform 4",
									"product_id": "red_hat_openshift_container_platform_4",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:openshift:4"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat OpenShift Container Platform 4"
					},
					{
						"category": "product_version",
						"name": "bubblewrap",
						"product": {
							"name": "bubblewrap",
							"product_id": "bubblewrap",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/bubblewrap?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "flatpak",
						"product": {
							"name": "flatpak",
							"product_id": "flatpak",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/flatpak?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "rhcos",
						"product": {
							"name": "rhcos",
							"product_id": "rhcos",
							"product_identification_helper": {
								"purl": "pkg:oci/rhcos"
							}
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "bubblewrap as a component of Red Hat Ansible Automation Platform 1.2",
					"product_id": "red_hat_ansible_automation_platform_1.2:bubblewrap"
				},
				"product_reference": "bubblewrap",
				"relates_to_product_reference": "red_hat_ansible_automation_platform_1.2"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "flatpak as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:flatpak"
				},
				"product_reference": "flatpak",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "bubblewrap as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:bubblewrap"
				},
				"product_reference": "bubblewrap",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "flatpak as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:flatpak"
				},
				"product_reference": "flatpak",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "bubblewrap as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:bubblewrap"
				},
				"product_reference": "bubblewrap",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "flatpak as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:flatpak"
				},
				"product_reference": "flatpak",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rhcos as a component of Red Hat OpenShift Container Platform 4",
					"product_id": "red_hat_openshift_container_platform_4:rhcos"
				},
				"product_reference": "rhcos",
				"relates_to_product_reference": "red_hat_openshift_container_platform_4"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2024-42472",
			"cwe": {
				"id": "CWE-74",
				"name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"
			},
			"discovery_date": "2024-08-15T19:20:31.644253+00:00",
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2305202"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "A sandbox escape vulnerability was found in Flatpak due to a symlink-following issue when mounting persistent directories. This flaw allows a local user or attacker to craft a symbolic link that can bypass the intended restrictions, enabling access to and modification of files outside the designated sandbox. As a result, the attacker could potentially manipulate the file system, leading to unauthorized actions that compromise the security and integrity of the system.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "flatpak: Access to files outside sandbox for apps using persistent= (--persist)",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "This vulnerability in Flatpak represents a significant severity issue due to its potential to undermine the core principles of application sandboxing, which are designed to isolate applications and protect the integrity and confidentiality of the system. By exploiting the persistent=subdir option, a malicious or compromised application can manipulate bind mounts via symlinks, thereby escaping the confines of its designated sandbox. This allows unauthorized access to the host filesystem, enabling the potential for unauthorized data manipulation, exfiltration, or system compromise. The risk is further exacerbated by the presence of a race condition, which can be exploited by running multiple instances of a malicious app concurrently.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_affected": [
					"red_hat_enterprise_linux_7:flatpak",
					"red_hat_enterprise_linux_8:flatpak",
					"red_hat_enterprise_linux_9:flatpak"
				],
				"under_investigation": [
					"red_hat_ansible_automation_platform_1.2:bubblewrap",
					"red_hat_enterprise_linux_8:bubblewrap",
					"red_hat_enterprise_linux_9:bubblewrap",
					"red_hat_openshift_container_platform_4:rhcos"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2024-42472"
				},
				{
					"category": "external",
					"summary": "RHBZ#2305202",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2305202"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2024-42472",
					"url": "https://www.cve.org/CVERecord?id=CVE-2024-42472"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-42472",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2024-42472"
				},
				{
					"category": "external",
					"summary": "https://github.com/containers/bubblewrap/commit/68e75c3091c87583c28a439b45c45627a94d622c",
					"url": "https://github.com/containers/bubblewrap/commit/68e75c3091c87583c28a439b45c45627a94d622c"
				},
				{
					"category": "external",
					"summary": "https://github.com/containers/bubblewrap/commit/a253257cd298892da43e15201d83f9a02c9b58b5",
					"url": "https://github.com/containers/bubblewrap/commit/a253257cd298892da43e15201d83f9a02c9b58b5"
				},
				{
					"category": "external",
					"summary": "https://github.com/flatpak/flatpak/commit/2cdd1e1e5ae90d7c3a4b60ce2e36e4d609e44e72",
					"url": "https://github.com/flatpak/flatpak/commit/2cdd1e1e5ae90d7c3a4b60ce2e36e4d609e44e72"
				},
				{
					"category": "external",
					"summary": "https://github.com/flatpak/flatpak/commit/3caeb16c31a3ed62d744e2aaf01d684f7991051a",
					"url": "https://github.com/flatpak/flatpak/commit/3caeb16c31a3ed62d744e2aaf01d684f7991051a"
				},
				{
					"category": "external",
					"summary": "https://github.com/flatpak/flatpak/commit/6bd603f6836e9b38b9b937d3b78f3fbf36e7ff75",
					"url": "https://github.com/flatpak/flatpak/commit/6bd603f6836e9b38b9b937d3b78f3fbf36e7ff75"
				},
				{
					"category": "external",
					"summary": "https://github.com/flatpak/flatpak/commit/7c63e53bb2af0aae9097fd2edfd6a9ba9d453e97",
					"url": "https://github.com/flatpak/flatpak/commit/7c63e53bb2af0aae9097fd2edfd6a9ba9d453e97"
				},
				{
					"category": "external",
					"summary": "https://github.com/flatpak/flatpak/commit/8a18137d7e80f0575e8defabf677d81e5cc3a788",
					"url": "https://github.com/flatpak/flatpak/commit/8a18137d7e80f0575e8defabf677d81e5cc3a788"
				},
				{
					"category": "external",
					"summary": "https://github.com/flatpak/flatpak/commit/db3a785241fda63bf53f0ec12bb519aa5210de19",
					"url": "https://github.com/flatpak/flatpak/commit/db3a785241fda63bf53f0ec12bb519aa5210de19"
				},
				{
					"category": "external",
					"summary": "https://github.com/flatpak/flatpak/security/advisories/GHSA-7hgv-f2j8-xw87",
					"url": "https://github.com/flatpak/flatpak/security/advisories/GHSA-7hgv-f2j8-xw87"
				}
			],
			"release_date": "2024-08-14T00:00:00+00:00",
			"remediations": [
				{
					"category": "workaround",
					"details": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
					"product_ids": [
						"red_hat_ansible_automation_platform_1.2:bubblewrap",
						"red_hat_enterprise_linux_7:flatpak",
						"red_hat_enterprise_linux_8:bubblewrap",
						"red_hat_enterprise_linux_8:flatpak",
						"red_hat_enterprise_linux_9:bubblewrap",
						"red_hat_enterprise_linux_9:flatpak",
						"red_hat_openshift_container_platform_4:rhcos"
					]
				},
				{
					"category": "none_available",
					"details": "Affected",
					"product_ids": [
						"red_hat_enterprise_linux_7:flatpak",
						"red_hat_enterprise_linux_8:flatpak",
						"red_hat_enterprise_linux_9:flatpak"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "HIGH",
						"attackVector": "NETWORK",
						"availabilityImpact": "NONE",
						"baseScore": 7.4,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"privilegesRequired": "NONE",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
						"version": "3.1"
					},
					"products": [
						"red_hat_ansible_automation_platform_1.2:bubblewrap",
						"red_hat_enterprise_linux_7:flatpak",
						"red_hat_enterprise_linux_8:bubblewrap",
						"red_hat_enterprise_linux_8:flatpak",
						"red_hat_enterprise_linux_9:bubblewrap",
						"red_hat_enterprise_linux_9:flatpak",
						"red_hat_openshift_container_platform_4:rhcos"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"details": "Important",
					"product_ids": [
						"red_hat_ansible_automation_platform_1.2:bubblewrap",
						"red_hat_enterprise_linux_7:flatpak",
						"red_hat_enterprise_linux_8:bubblewrap",
						"red_hat_enterprise_linux_8:flatpak",
						"red_hat_enterprise_linux_9:bubblewrap",
						"red_hat_enterprise_linux_9:flatpak",
						"red_hat_openshift_container_platform_4:rhcos"
					]
				}
			],
			"title": "flatpak: Access to files outside sandbox for apps using persistent= (--persist)"
		}
	]
}
