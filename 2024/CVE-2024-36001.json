{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "moderate"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/v2/vex/2024/cve-2024-36001.json"
			}
		],
		"title": "kernel: netfs: Fix the pre-flush when appending to a file in writethrough mode",
		"tracking": {
			"current_release_date": "2024-10-01T12:11:44+00:00",
			"generator": {
				"date": "2024-10-01T12:11:44+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "4.0.0"
				}
			},
			"id": "CVE-2024-36001",
			"initial_release_date": "2024-05-20T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2024-05-20T00:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-10-01T11:59:13+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-10-01T12:11:44+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 6",
								"product": {
									"name": "Red Hat Enterprise Linux 6",
									"product_id": "red_hat_enterprise_linux_6",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:6"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 6"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 7",
								"product": {
									"name": "Red Hat Enterprise Linux 7",
									"product_id": "red_hat_enterprise_linux_7",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:7"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 7"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 8",
								"product": {
									"name": "Red Hat Enterprise Linux 8",
									"product_id": "red_hat_enterprise_linux_8",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:8"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 8"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 9",
								"product": {
									"name": "Red Hat Enterprise Linux 9",
									"product_id": "red_hat_enterprise_linux_9",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:9"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 9"
					},
					{
						"category": "product_version",
						"name": "kernel",
						"product": {
							"name": "kernel",
							"product_id": "kernel",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/kernel?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "kernel-rt",
						"product": {
							"name": "kernel-rt",
							"product_id": "kernel-rt",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/kernel-rt?arch=src"
							}
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 6",
					"product_id": "red_hat_enterprise_linux_6:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_6"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2024-36001",
			"discovery_date": "2024-05-20T00:00:00+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"red_hat_enterprise_linux_6:kernel",
						"red_hat_enterprise_linux_7:kernel",
						"red_hat_enterprise_linux_7:kernel-rt",
						"red_hat_enterprise_linux_8:kernel",
						"red_hat_enterprise_linux_8:kernel-rt",
						"red_hat_enterprise_linux_9:kernel",
						"red_hat_enterprise_linux_9:kernel-rt"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2281964"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfs: Fix the pre-flush when appending to a file in writethrough mode\n\nIn netfs_perform_write(), when the file is marked NETFS_ICTX_WRITETHROUGH\nor O_*SYNC or RWF_*SYNC was specified, write-through caching is performed\non a buffered file.  When setting up for write-through, we flush any\nconflicting writes in the region and wait for the write to complete,\nfailing if there's a write error to return.\n\nThe issue arises if we're writing at or above the EOF position because we\nskip the flush and - more importantly - the wait.  This becomes a problem\nif there's a partial folio at the end of the file that is being written out\nand we want to make a write to it too.  Both the already-running write and\nthe write we start both want to clear the writeback mark, but whoever is\nsecond causes a warning looking something like:\n\n    ------------[ cut here ]------------\n    R=00000012: folio 11 is not under writeback\n    WARNING: CPU: 34 PID: 654 at fs/netfs/write_collect.c:105\n    ...\n    CPU: 34 PID: 654 Comm: kworker/u386:27 Tainted: G S ...\n    ...\n    Workqueue: events_unbound netfs_write_collection_worker\n    ...\n    RIP: 0010:netfs_writeback_lookup_folio\n\nFix this by making the flush-and-wait unconditional.  It will do nothing if\nthere are no folios in the pagecache and will return quickly if there are\nno folios in the region specified.\n\nFurther, move the WBC attachment above the flush call as the flush is going\nto attach a WBC and detach it again if it is not present - and since we\nneed one anyway we might as well share it.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "kernel: netfs: Fix the pre-flush when appending to a file in writethrough mode",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "Red Hat Enterprise Linux is not impacted by this CVE, as the vulnerability in question does not affect the specific versions or configurations of the Linux kernel used in its distributions. This ensures that users of Red Hat Enterprise Linux are not exposed to the potential risks associated with this issue, and no further action or mitigation is necessary for systems running this operating system.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_not_affected": [
					"red_hat_enterprise_linux_6:kernel",
					"red_hat_enterprise_linux_7:kernel",
					"red_hat_enterprise_linux_7:kernel-rt",
					"red_hat_enterprise_linux_8:kernel",
					"red_hat_enterprise_linux_8:kernel-rt",
					"red_hat_enterprise_linux_9:kernel",
					"red_hat_enterprise_linux_9:kernel-rt"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2024-36001"
				},
				{
					"category": "external",
					"summary": "RHBZ#2281964",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2281964"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2024-36001",
					"url": "https://www.cve.org/CVERecord?id=CVE-2024-36001"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-36001",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2024-36001"
				},
				{
					"category": "external",
					"summary": "https://lore.kernel.org/linux-cve-announce/2024052023-CVE-2024-36001-e6a9@gregkh/T",
					"url": "https://lore.kernel.org/linux-cve-announce/2024052023-CVE-2024-36001-e6a9@gregkh/T"
				}
			],
			"release_date": "2024-05-20T00:00:00+00:00",
			"remediations": [
				{
					"category": "workaround",
					"details": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
					"product_ids": [
						"red_hat_enterprise_linux_6:kernel",
						"red_hat_enterprise_linux_7:kernel",
						"red_hat_enterprise_linux_7:kernel-rt",
						"red_hat_enterprise_linux_8:kernel",
						"red_hat_enterprise_linux_8:kernel-rt",
						"red_hat_enterprise_linux_9:kernel",
						"red_hat_enterprise_linux_9:kernel-rt"
					]
				}
			],
			"title": "kernel: netfs: Fix the pre-flush when appending to a file in writethrough mode"
		}
	]
}
