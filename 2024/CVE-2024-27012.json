{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "low"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/v2/vex/2024/cve-2024-27012.json"
			}
		],
		"title": "kernel: netfilter: nf_tables: restore set elements when delete set fails",
		"tracking": {
			"current_release_date": "2024-09-27T11:28:36+00:00",
			"generator": {
				"date": "2024-09-27T11:28:36+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "4.0.0"
				}
			},
			"id": "CVE-2024-27012",
			"initial_release_date": "2024-05-01T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2024-05-01T00:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-06-09T16:57:45+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-09-27T11:28:36+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 6",
								"product": {
									"name": "Red Hat Enterprise Linux 6",
									"product_id": "red_hat_enterprise_linux_6",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:6"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 6"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 7",
								"product": {
									"name": "Red Hat Enterprise Linux 7",
									"product_id": "red_hat_enterprise_linux_7",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:7"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 7"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 8",
								"product": {
									"name": "Red Hat Enterprise Linux 8",
									"product_id": "red_hat_enterprise_linux_8",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:8"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 8"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Enterprise Linux 9",
								"product": {
									"name": "Red Hat Enterprise Linux 9",
									"product_id": "red_hat_enterprise_linux_9",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:9"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Enterprise Linux 9"
					},
					{
						"category": "product_version",
						"name": "kernel",
						"product": {
							"name": "kernel",
							"product_id": "kernel",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/kernel?arch=src"
							}
						}
					},
					{
						"category": "product_version",
						"name": "kernel-rt",
						"product": {
							"name": "kernel-rt",
							"product_id": "kernel-rt",
							"product_identification_helper": {
								"purl": "pkg:rpm/redhat/kernel-rt?arch=src"
							}
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 6",
					"product_id": "red_hat_enterprise_linux_6:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_6"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 7",
					"product_id": "red_hat_enterprise_linux_7:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 8",
					"product_id": "red_hat_enterprise_linux_8:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:kernel"
				},
				"product_reference": "kernel",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "kernel-rt as a component of Red Hat Enterprise Linux 9",
					"product_id": "red_hat_enterprise_linux_9:kernel-rt"
				},
				"product_reference": "kernel-rt",
				"relates_to_product_reference": "red_hat_enterprise_linux_9"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2024-27012",
			"discovery_date": "2024-05-01T00:00:00+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"red_hat_enterprise_linux_6:kernel",
						"red_hat_enterprise_linux_8:kernel",
						"red_hat_enterprise_linux_8:kernel-rt"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2278275"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: restore set elements when delete set fails\n\nFrom abort path, nft_mapelem_activate() needs to restore refcounters to\nthe original state. Currently, it uses the set->ops->walk() to iterate\nover these set elements. The existing set iterator skips inactive\nelements in the next generation, this does not work from the abort path\nto restore the original state since it has to skip active elements\ninstead (not inactive ones).\n\nThis patch moves the check for inactive elements to the set iterator\ncallback, then it reverses the logic for the .activate case which\nneeds to skip active elements.\n\nToggle next generation bit for elements when delete set command is\ninvoked and call nft_clear() from .activate (abort) path to restore the\nnext generation bit.\n\nThe splat below shows an object in mappings memleak:\n\n[43929.457523] ------------[ cut here ]------------\n[43929.457532] WARNING: CPU: 0 PID: 1139 at include/net/netfilter/nf_tables.h:1237 nft_setelem_data_deactivate+0xe4/0xf0 [nf_tables]\n[...]\n[43929.458014] RIP: 0010:nft_setelem_data_deactivate+0xe4/0xf0 [nf_tables]\n[43929.458076] Code: 83 f8 01 77 ab 49 8d 7c 24 08 e8 37 5e d0 de 49 8b 6c 24 08 48 8d 7d 50 e8 e9 5c d0 de 8b 45 50 8d 50 ff 89 55 50 85 c0 75 86 <0f> 0b eb 82 0f 0b eb b3 0f 1f 40 00 90 90 90 90 90 90 90 90 90 90\n[43929.458081] RSP: 0018:ffff888140f9f4b0 EFLAGS: 00010246\n[43929.458086] RAX: 0000000000000000 RBX: ffff8881434f5288 RCX: dffffc0000000000\n[43929.458090] RDX: 00000000ffffffff RSI: ffffffffa26d28a7 RDI: ffff88810ecc9550\n[43929.458093] RBP: ffff88810ecc9500 R08: 0000000000000001 R09: ffffed10281f3e8f\n[43929.458096] R10: 0000000000000003 R11: ffff0000ffff0000 R12: ffff8881434f52a0\n[43929.458100] R13: ffff888140f9f5f4 R14: ffff888151c7a800 R15: 0000000000000002\n[43929.458103] FS:  00007f0c687c4740(0000) GS:ffff888390800000(0000) knlGS:0000000000000000\n[43929.458107] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[43929.458111] CR2: 00007f58dbe5b008 CR3: 0000000123602005 CR4: 00000000001706f0\n[43929.458114] Call Trace:\n[43929.458118]  <TASK>\n[43929.458121]  ? __warn+0x9f/0x1a0\n[43929.458127]  ? nft_setelem_data_deactivate+0xe4/0xf0 [nf_tables]\n[43929.458188]  ? report_bug+0x1b1/0x1e0\n[43929.458196]  ? handle_bug+0x3c/0x70\n[43929.458200]  ? exc_invalid_op+0x17/0x40\n[43929.458211]  ? nft_setelem_data_deactivate+0xd7/0xf0 [nf_tables]\n[43929.458271]  ? nft_setelem_data_deactivate+0xe4/0xf0 [nf_tables]\n[43929.458332]  nft_mapelem_deactivate+0x24/0x30 [nf_tables]\n[43929.458392]  nft_rhash_walk+0xdd/0x180 [nf_tables]\n[43929.458453]  ? __pfx_nft_rhash_walk+0x10/0x10 [nf_tables]\n[43929.458512]  ? rb_insert_color+0x2e/0x280\n[43929.458520]  nft_map_deactivate+0xdc/0x1e0 [nf_tables]\n[43929.458582]  ? __pfx_nft_map_deactivate+0x10/0x10 [nf_tables]\n[43929.458642]  ? __pfx_nft_mapelem_deactivate+0x10/0x10 [nf_tables]\n[43929.458701]  ? __rcu_read_unlock+0x46/0x70\n[43929.458709]  nft_delset+0xff/0x110 [nf_tables]\n[43929.458769]  nft_flush_table+0x16f/0x460 [nf_tables]\n[43929.458830]  nf_tables_deltable+0x501/0x580 [nf_tables]",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "kernel: netfilter: nf_tables: restore set elements when delete set fails",
					"title": "Vulnerability summary"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_affected": [
					"red_hat_enterprise_linux_7:kernel",
					"red_hat_enterprise_linux_7:kernel-rt"
				],
				"known_not_affected": [
					"red_hat_enterprise_linux_6:kernel",
					"red_hat_enterprise_linux_8:kernel",
					"red_hat_enterprise_linux_8:kernel-rt"
				],
				"under_investigation": [
					"red_hat_enterprise_linux_9:kernel",
					"red_hat_enterprise_linux_9:kernel-rt"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2024-27012"
				},
				{
					"category": "external",
					"summary": "RHBZ#2278275",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2278275"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2024-27012",
					"url": "https://www.cve.org/CVERecord?id=CVE-2024-27012"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-27012",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2024-27012"
				},
				{
					"category": "external",
					"summary": "https://lore.kernel.org/linux-cve-announce/2024050148-CVE-2024-27012-5564@gregkh/T",
					"url": "https://lore.kernel.org/linux-cve-announce/2024050148-CVE-2024-27012-5564@gregkh/T"
				}
			],
			"release_date": "2024-05-01T00:00:00+00:00",
			"remediations": [
				{
					"category": "no_fix_planned",
					"details": "Out of support scope",
					"product_ids": [
						"red_hat_enterprise_linux_7:kernel",
						"red_hat_enterprise_linux_7:kernel-rt"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "LOW",
						"attackVector": "LOCAL",
						"availabilityImpact": "HIGH",
						"baseScore": 5.5,
						"baseSeverity": "MEDIUM",
						"confidentialityImpact": "NONE",
						"integrityImpact": "NONE",
						"privilegesRequired": "LOW",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
						"version": "3.1"
					},
					"products": [
						"red_hat_enterprise_linux_7:kernel",
						"red_hat_enterprise_linux_7:kernel-rt",
						"red_hat_enterprise_linux_9:kernel",
						"red_hat_enterprise_linux_9:kernel-rt"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"details": "Low",
					"product_ids": [
						"red_hat_enterprise_linux_7:kernel",
						"red_hat_enterprise_linux_7:kernel-rt",
						"red_hat_enterprise_linux_9:kernel",
						"red_hat_enterprise_linux_9:kernel-rt"
					]
				}
			],
			"title": "kernel: netfilter: nf_tables: restore set elements when delete set fails"
		}
	]
}
