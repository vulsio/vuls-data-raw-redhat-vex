{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "important"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/beta/vex/2023/cve-2023-26031.json"
			}
		],
		"title": "hadoop-yarn-server-nodemanager: Untrusted search path may lead to privilege escalation via container-executor suid binary",
		"tracking": {
			"current_release_date": "2023-12-19T21:25:57+00:00",
			"generator": {
				"date": "2023-12-19T21:25:57+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.26.0"
				}
			},
			"id": "CVE-2023-26031",
			"initial_release_date": "2023-11-16T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2023-11-16T00:00:00+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2023-12-19T17:23:30+00:00",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2023-12-19T21:25:57+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"category": "product_name",
						"name": "Red Hat Integration Camel K",
						"product": {
							"name": "Red Hat Integration Camel K",
							"product_id": "red_hat_integration_camel_k",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:integration:1"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Fuse 6",
						"product": {
							"name": "Red Hat JBoss Fuse 6",
							"product_id": "red_hat_jboss_fuse_6",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_fuse:6"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat JBoss Fuse 7",
						"product": {
							"name": "Red Hat JBoss Fuse 7",
							"product_id": "red_hat_jboss_fuse_7",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:jboss_fuse:7"
							}
						}
					},
					{
						"category": "product_name",
						"name": "Red Hat OpenShift Container Platform 4",
						"product": {
							"name": "Red Hat OpenShift Container Platform 4",
							"product_id": "red_hat_openshift_container_platform_4",
							"product_identification_helper": {
								"cpe": "cpe:/a:redhat:openshift:4"
							}
						}
					},
					{
						"category": "product_version",
						"name": "hadoop-yarn-server-nodemanager",
						"product": {
							"name": "hadoop-yarn-server-nodemanager",
							"product_id": "hadoop-yarn-server-nodemanager"
						}
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "hadoop-yarn-server-nodemanager as a component of Red Hat Integration Camel K",
					"product_id": "red_hat_integration_camel_k:hadoop-yarn-server-nodemanager"
				},
				"product_reference": "hadoop-yarn-server-nodemanager",
				"relates_to_product_reference": "red_hat_integration_camel_k"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "hadoop-yarn-server-nodemanager as a component of Red Hat JBoss Fuse 6",
					"product_id": "red_hat_jboss_fuse_6:hadoop-yarn-server-nodemanager"
				},
				"product_reference": "hadoop-yarn-server-nodemanager",
				"relates_to_product_reference": "red_hat_jboss_fuse_6"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "hadoop-yarn-server-nodemanager as a component of Red Hat JBoss Fuse 7",
					"product_id": "red_hat_jboss_fuse_7:hadoop-yarn-server-nodemanager"
				},
				"product_reference": "hadoop-yarn-server-nodemanager",
				"relates_to_product_reference": "red_hat_jboss_fuse_7"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "hadoop-yarn-server-nodemanager as a component of Red Hat OpenShift Container Platform 4",
					"product_id": "red_hat_openshift_container_platform_4:hadoop-yarn-server-nodemanager"
				},
				"product_reference": "hadoop-yarn-server-nodemanager",
				"relates_to_product_reference": "red_hat_openshift_container_platform_4"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2023-26031",
			"cwe": {
				"id": "CWE-426",
				"name": "Untrusted Search Path"
			},
			"discovery_date": "2023-11-16T00:00:00+00:00",
			"flags": [
				{
					"label": "vulnerable_code_not_present",
					"product_ids": [
						"red_hat_jboss_fuse_7:hadoop-yarn-server-nodemanager"
					]
				}
			],
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2250137"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "Relative library resolution in linux container-executor binary in Apache Hadoop 3.3.1-3.3.4 on Linux allows local user to gain root privileges. If the YARN cluster is accepting work from remote (authenticated) users, this MAY permit remote users to gain root privileges. Hadoop 3.3.0 updated the \" YARN Secure Containers https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/SecureContainer.html \" to add a feature for executing user-submitted applications in isolated linux containers. The native binary HADOOP_HOME/bin/container-executor is used to launch these containers; it must be owned by root and have the suid bit set in order for the YARN processes to run the containers as the specific users submitting the jobs. The patch \" YARN-10495 https://issues.apache.org/jira/browse/YARN-10495 . make the rpath of container-executor configurable\" modified the library loading path for loading .so files from \"$ORIGIN/\" to \"\"$ORIGIN/:../lib/native/\". This is the a path through which libcrypto.so is located. Thus it is is possible for a user with reduced privileges to install a malicious libcrypto library into a path to which they have write access, invoke the container-executor command, and have their modified library executed as root. If the YARN cluster is accepting work from remote (authenticated) users, and these users' submitted job are executed in the physical host, rather than a container, then the CVE permits remote users to gain root privileges. The fix for the vulnerability is to revert the change, which is done in YARN-11441 https://issues.apache.org/jira/browse/YARN-11441 , \"Revert YARN-10495\". This patch is in hadoop-3.3.5. To determine whether a version of container-executor is vulnerable, use the readelf command. If the RUNPATH or RPATH value contains the relative path \"./lib/native/\" then it is at risk $ readelf -d container-executor|grep 'RUNPATH\\|RPATH' 0x000000000000001d (RUNPATH) Library runpath: [$ORIGIN/:../lib/native/] If it does not, then it is safe: $ readelf -d container-executor|grep 'RUNPATH\\|RPATH' 0x000000000000001d (RUNPATH) Library runpath: [$ORIGIN/] For an at-risk version of container-executor to enable privilege escalation, the owner must be root and the suid bit must be set $ ls -laF /opt/hadoop/bin/container-executor ---Sr-s---. 1 root hadoop 802968 May 9 20:21 /opt/hadoop/bin/container-executor A safe installation lacks the suid bit; ideally is also not owned by root. $ ls -laF /opt/hadoop/bin/container-executor -rwxr-xr-x. 1 yarn hadoop 802968 May 9 20:21 /opt/hadoop/bin/container-executor This configuration does not support Yarn Secure Containers, but all other hadoop services, including YARN job execution outside secure containers continue to work.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "hadoop-yarn-server-nodemanager: Untrusted search path may lead to privilege escalation via container-executor suid binary",
					"title": "Vulnerability summary"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"known_affected": [
					"red_hat_integration_camel_k:hadoop-yarn-server-nodemanager",
					"red_hat_jboss_fuse_6:hadoop-yarn-server-nodemanager",
					"red_hat_openshift_container_platform_4:hadoop-yarn-server-nodemanager"
				],
				"known_not_affected": [
					"red_hat_jboss_fuse_7:hadoop-yarn-server-nodemanager"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2023-26031"
				},
				{
					"category": "external",
					"summary": "RHBZ#2250137",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2250137"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2023-26031",
					"url": "https://www.cve.org/CVERecord?id=CVE-2023-26031"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2023-26031",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2023-26031"
				}
			],
			"release_date": "2023-11-16T00:00:00+00:00",
			"remediations": [
				{
					"category": "no_fix_planned",
					"details": "Out of support scope",
					"product_ids": [
						"red_hat_jboss_fuse_6:hadoop-yarn-server-nodemanager"
					]
				},
				{
					"category": "none_available",
					"details": "Affected",
					"product_ids": [
						"red_hat_integration_camel_k:hadoop-yarn-server-nodemanager",
						"red_hat_openshift_container_platform_4:hadoop-yarn-server-nodemanager"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "HIGH",
						"attackVector": "NETWORK",
						"availabilityImpact": "HIGH",
						"baseScore": 7.5,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"privilegesRequired": "LOW",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"red_hat_integration_camel_k:hadoop-yarn-server-nodemanager",
						"red_hat_jboss_fuse_6:hadoop-yarn-server-nodemanager",
						"red_hat_openshift_container_platform_4:hadoop-yarn-server-nodemanager"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"details": "Low",
					"product_ids": [
						"red_hat_integration_camel_k:hadoop-yarn-server-nodemanager"
					]
				},
				{
					"category": "impact",
					"details": "Important",
					"product_ids": [
						"red_hat_jboss_fuse_6:hadoop-yarn-server-nodemanager",
						"red_hat_openshift_container_platform_4:hadoop-yarn-server-nodemanager"
					]
				}
			],
			"title": "hadoop-yarn-server-nodemanager: Untrusted search path may lead to privilege escalation via container-executor suid binary"
		}
	]
}
